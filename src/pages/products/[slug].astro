---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import ProductCard from '../../components/ProductCard.astro';
import { getProductBySlug, products, type Product } from '../../data/products';

export function getStaticPaths() {
  return products.map(product => ({ params: { slug: product.slug } }));
}

const { slug } = Astro.params;
const product = getProductBySlug(slug);

if (!product) {
  return Astro.redirect('/404');
}

const relatedProducts = products
  .filter(p => p.category === product.category && p.id !== product.id)
  .slice(0, 3);
---

<Layout title={`${product.name} Review - ${product.description}`} type="product">
  <Header />

  <main>
    <section class="bg-off-black py-4">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <nav class="text-sm">
          <a href="/" class="text-gold hover:underline">Home</a>
          <span class="text-gray-500 mx-2">/</span>
          <span class="text-gray-400">{product.name}</span>
        </nav>
      </div>
    </section>

    <section class="bg-gradient-to-br from-off-black via-dark-gray to-off-black py-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-off-white mb-4">
          {product.name} Review
        </h1>

        <a
          href={product.affiliateLink}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-block bg-gold hover:bg-gold-dark text-off-black font-bold py-4 px-8 rounded-lg text-lg transition-colors duration-300"
        >
          Visit Official Site &rarr;
        </a>
      </div>
    </section>
  </main>

  <Footer />
</Layout>
